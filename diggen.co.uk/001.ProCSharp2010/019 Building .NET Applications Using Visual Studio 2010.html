<!DOCTYPE HTML>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />   
	<link rel="stylesheet" type="text/css" href="http://www.diggen.co.uk/csharp.css" />       
	<link rel="stylesheet" type="text/css" href="http://www.diggen.co.uk/master.css" />  
</head>
<body>
    <h1>Building .NET Applications Using Visual Studio 2010</h1>
     <p>If you are a professional .NET software engineer, the chances are extremely good that your employer has
    purchased Microsoft's premier IDE, Visual Studio 2010, for your development endeavors
    (http://msdn.microsoft.com/vstudio). This tool is far and away the most feature-rich, enterprise-ready
    IDE examined in this chapter. Of course, this power comes at a price, which will vary based on the
    version of Visual Studio 2010 you purchase. As you might suspect, each version supplies a unique set of
    features.</p>
    <p><b>Note</b> There is a staggering number of members within the Visual Studio 2010 family. My assumption during
    the remainder of this text is that you have chosen to make use of Visual Studio 2010 Professional as your IDE of
    choice.</p>
    <p>Although I will assume you have a copy of Visual Studio 2010 Professional, understand that owning
    a copy of this IDE is not required to use this edition of the text. In the worst case, I may examine an
    option that is not provided by your IDE. However, rest assured that all of this book's sample code will
    compile just fine when processed by your tool of choice.</p>
    <p><b>Note</b> Once you download the source code for this book from the Source Code/Downloads area of the Apress
    web site (http://www.apress.com), you may load the current example into Visual Studio 2010 (or C# 2010
    Express) by double-clicking the example's *.sln file. If you are not using Visual Studio 2010/C# 2010 Express,
    you will need to manually insert the provided *.cs files into your IDE's project work space.</p>
    <h2>Some Unique Features of Visual Studio 2010</h2>
    <p>Visual Studio 2010 ships with the expected GUI designers, code snippet support, database manipulation
    tools, object and project browsing utilities, and an integrated help system. Unlike many of the IDEs we
    have already examined, Visual Studio 2010 provides numerous additions. Here is a partial list.</p>
    <ul>
        <li>Visual XML editors/designers</li>
        <li>Support for Windows mobile device development</li>
        <li>Support for Microsoft Office development</li>
        <li>Designer support for Windows Workflow Foundation projects</li>
        <li>Integrated support for code refactoring</li>
        <li>Visual class designer tools</li>
    </ul>
    <p>To be completely honest, Visual Studio 2010 provides so many features that it would take an entire
    book (a rather large book at that) to fully describe every aspect of the IDE. This is not that book. However,
    I do want to point out some of the major features in the pages that follow. As you progress through the
    text, you'll learn more about the Visual Studio 2010 IDE where appropriate.</p>
    <h2>Targeting the .NET Framework Using the New Project Dialog Box</h2>
    <p>If you are following along, create a new C# Console Application (named Vs2010Example) using the File
    ? New ? Project menu item. As you can see in Figure 2-9, Visual Studio 2010 supports the ability to
    select which version of the .NET Framework you wish to build against (2.0, 3.x, or 4.0) using the dropdown
    list box on the top center of the New Project dialog box. For each project in this text, you can
    simply leave the default selection of .NET Framework 4.0.</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_09.png" alt="Figure 2-9" />
    <p><b>Figure 2-9</b> Visual Studio 2010 allows you to target a particular version of the .NET Framework</p>
    <h2>Using the Solution Explorer Utility</h2>
    <p>The Solution Explorer utility (accessible from the View menu) allows you to view the set of all content
    files and referenced assemblies that comprise the current project (see Figure 2-10).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_10.png" alt="Figure 2-10" />
    <p><b>Figure 2-10</b> The Solution Explorer utility</p>
    <p>Notice that the References folder of Solution Explorer displays a list of each assembly you have
    currently referenced, which will differ based on the type of project you select and the version of the
    Framework you are compiling against.</p>
    <h2>Referencing External Assemblies</h2>
    <p>When you need to reference additional assemblies, right-click the References folder and select Add
    Reference. At this point, you can select your assembly from the resulting dialog box (this is essentially
    the way Visual Studio allows you to specify the /reference option of the command-line compiler). The
    .NET tab (see Figure 2-11) displays a number of commonly used .NET assemblies; however, the Browse
    tab allows you to navigate to any .NET assembly on your hard drive. Also, the very useful Recent tab
    keeps a running tally of frequently referenced assemblies you have used in other projects.</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_11.png" alt="Figure 2-11" />
    <p><b>Figure 2-11</b> The Add Reference dialog box</p>
    <h2>Viewing Project Properties</h2>
    <p>Finally, notice an icon named Properties within Solution Explorer. When you double-click this item, you
    are presented with a sophisticated project configuration editor (see Figure 2-12).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_12.png" alt="Figure 2-12" />
    <p><b>Figure 2-12</b> The Project Properties window</p>
    <p>You will see various aspects of the Project Properties window as you progress through this book.
    However, if you take some time to poke around, you will see that you can establish various security
    settings, strongly name your assembly, deploy your application, insert application resources, and
    configure pre- and post-build events.</p>
    <h2>The Class View Utility</h2>
    <p>The next tool to examine is the Class View utility, which you can load from the View menu. The purpose
    of this utility is to show all of the types in your current project from an object-oriented perspective
    (rather than a file-based view of Solution Explorer). The top pane displays the set of namespaces and
    their types, while the bottom pane displays the currently selected type's members (see Figure 2-13).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_13.png" alt="Figure 2-13" />
    <p><b>Figure 2-13</b> The Class View utility</p>
    <p>When you double click on a type or type member using the Class View tool, Visual Studio will
    automatically open the correct C# code file, and place your mouse cursor at the correct location.
    Another nice feature of the Visual Studio 2010 Class View tool is that you are able to open up any
    referenced assembly and drill into the contained namespaces, types, and members (Figure 2-14).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_14.png" alt="Figure 2-14" />
    <p><b>Figure 2-14</b> The Class View utility can also be used to view referenced assemblies</p>
    <h2>The Object Browser Utility</h2>
    <p>Visual Studio 2010 also provides a second utility to investigate the set of referenced assemblies within
    your current project. Activate the Object Browser using the View menu, and then select the assembly you
    wish to investigate (see Figure 2-15).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_15.png" alt="Figure 2-15" />
    <p><b>Figure 2-15</b> The Object Browser utility</p>
    <h2>Integrated Support for Code Refactoring</h2>
    <p>One major feature that ships with Visual Studio 2010 is support to refactor existing code. Simply put,
    refactoring is a formal and mechanical process whereby you improve an existing code base. In the bad
    old days, refactoring typically involved a ton of manual labor. Luckily, Visual Studio 2010 does a great
    deal to automate the refactoring process.</p>
    <p>Using the Refactor menu (which will only be available when a code file is active), related keyboard
    shortcuts, smart tags, and/or context-sensitive mouse clicks, you can dramatically reshape your code
    with minimal fuss and bother. Table 2-2 defines some common refactorings recognized by Visual Studio
    2010.</p>
    <p><b>Table 2-2.</b> Visual Studio 2010 Refactorings</p>
    <table class="gridtable">
        <tr>
            <th>Refactoring Technique</th>
            <th>Meaning in Life</th>
        </tr>
        <tr>
            <td>Extract Method</td>
            <td>Allows you to define a new method based on a selection of code statements</td>
        </tr>
        <tr>
            <td>Encapsulate Field</td>
            <td>Turns a public field into a private field encapsulated by a C# property</td>
        </tr>
        <tr>
            <td>Extract Interface</td>
            <td>Defines a new interface type based on a set of existing type members</td>
        </tr>
        <tr>
            <td>Reorder Parameters</td>
            <td>Provide a way to reorder member arguments</td>
        </tr>
        <tr>
            <td>Remove Parameters</td>
            <td>Remove a given argument from the current list of parameters (as you would expect)</td>
        </tr>
        <tr>
            <td>Rename</td>
            <td>Allows you to rename a code token (method name, field, local variable, and so on) throughout a project</td>
        </tr>
    </table>
     <p>To illustrate refactoring in action, update your Main() method with the following simple code:</p>
     <!-- code formatted by http://manoli.net/csharpformat/ -->
<pre class="csharpcode">
<span class="kwrd">static</span> <span class="kwrd">void</span> Main(<span class="kwrd">string</span>[] args)
{
    <span class="rem">// Set up Console UI (CUI)</span>
    Console.Title = <span class="str">"My Rocking App"</span>;
    Console.ForegroundColor = ConsoleColor.Yellow;
    Console.BackgroundColor = ConsoleColor.Blue;
    Console.WriteLine(<span class="str">"*************************************"</span>);
    Console.WriteLine(<span class="str">"***** Welcome to My Rocking App *****"</span>);
    Console.WriteLine(<span class="str">"*************************************"</span>);
    Console.BackgroundColor = ConsoleColor.Black;
    
    <span class="rem">// Wait for Enter key to be pressed.</span>
    Console.ReadLine();
}</pre>
    <p>While there is nothing wrong with the preceding code as it now stands, imagine that you want to
    display this welcome message at various places throughout your program. Rather than retyping the
    same exact console user interface logic, it would be ideal to have a helper function that could be called to
    do so. Given this, you will apply the Extract Method refactoring to your existing code.</p>
     <p>First, select each code statement within Main() (except the final call to Console.ReadLine()) using
    the editor. Then right-click the selected text and select the Extract Method option within the Refactor
    context menu (see Figure 2-16).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_16.png" alt="Figure 2-16" />
    <p><b>Figure 2-16</b> Activating a code refactoring</p>
    <p>Name your new method ConfigureCUI using the resulting dialog box. When you have finished, you
    will find that your Main() method calls the newly generated ConfigureCUI() method, which now
    contains the previously selected code.</p>
    <!-- code formatted by http://manoli.net/csharpformat/ -->
<pre class="csharpcode">
<span class="kwrd">class</span> Program
{
    <span class="kwrd">static</span> <span class="kwrd">void</span> Main(<span class="kwrd">string</span>[] args)
    {
        ConfigureCUI();

        <span class="rem">// Wait for key press to close.</span>
        Console.ReadLine();
    }

    <span class="kwrd">private</span> <span class="kwrd">static</span> <span class="kwrd">void</span> ConfigureCUI()
    {
        <span class="rem">// Set up Console UI (CUI)</span>
        Console.Title = <span class="str">"My Rocking App"</span>;
        Console.ForegroundColor = ConsoleColor.Yellow;
        Console.BackgroundColor = ConsoleColor.Blue;
        Console.WriteLine(<span class="str">"*************************************"</span>);
        Console.WriteLine(<span class="str">"***** Welcome to My Rocking App *****"</span>);
        Console.WriteLine(<span class="str">"*************************************"</span>);
        Console.BackgroundColor = ConsoleColor.Black;
    }
}</pre>
    <p>This is a simple example of using the built-in refactorings of Visual Studio 2010, and you'll see
    additional examples here and there over the course of this text.</p>
    <h2>Code Expansions and Surround With Technology</h2>
    <p>Visual Studio 2010 (as well as Visual C# 2010 Express) is capable of inserting prefabricated blocks of C#
    code using menu selections, context-sensitive mouse clicks, and/or keyboard shortcuts. The number of
    available code expansions is impressive and can be broken down into two main groups.
    </p>
    <ul>
        <li>Snippets: These templates insert common code blocks at the location of the mouse cursor.</li>
        <li>Surround With: These templates wrap a block of selected statements within a relevant scope.</li>
    </ul>
    <p>To see this functionality firsthand, assume that you wish to iterate over the incoming parameters of
    the Main() method using a foreach construct. Rather than typing the code in by hand, you can activate
    the foreach code snippet. When you have done so, the IDE will dump out a foreach code template at the
    current location of the mouse cursor.</p>
    <p>To illustrate, place the mouse cursor after the initial opening curly bracket of Main(). One way to
    activate a code snippet is to right-click the mouse and activate the Insert Snippet (or Surround With)
    menu option. Here, you will find a list of all code snippets of this category (press the Esc key to dismiss
    the pop-up menu). As a shortcut, however, you can simply type in the name of the code snippet,
    foreach in this case. In Figure 2-17, notice how the icon for a code snippet looks a bit like a torn piece of
    paper.</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_17.png" alt="Figure 2-17" />
    <p><b>Figure 2-17</b> Activating a code snippet</p>
    <p>Once you find the snippet you want to activate, press the Tab key twice. This will autocomplete the
    entire snippet and leave a set of placeholders that you can fill in to complete the snippet. If you press the
    Tab key, you can cycle between each placeholder and fill in the gaps (press the Esc key to exit the code
    snippet edit mode).</p>
    <p>If you were to right-click and select the Surround With menu, you would likewise be presented with
    a list of options. Recall that when using Surround With snippets, typically you first select a block of code
    statements to represent what should be used to wrap them (e.g., try/catch block). Be sure to take time to
    explore these predefined code expansion templates, as they can radically speed up the development
    process.</p>
    <p><b>Note</b> All code expansion templates are XML-based descriptions of the code to generate within the IDE.
    Using Visual Studio 2010 (as well as Visual C# 2010 Express), you can create your own custom code templates.
    Details of how to do so can be found in my article 'Investigating Code Snippet Technology' at http://msdn.
    microsoft.com.</p>
    <h2>The Visual Class Designer</h2>
    <p>Visual Studio 2010 gives us the ability to design classes visually (this capability is not included in Visual
    C# 2010 Express). The Class Designer utility allows you to view and modify the relationships of the types
    (classes, interfaces, structures, enumerations, and delegates) in your project. Using this tool, you are
    able to visually add (or remove) members to (or from) a type and have your modifications reflected in
    the corresponding C# file. Also, as you modify a given C# file, changes are reflected in the class diagram.</p>
    <p>To work with this aspect of Visual Studio 2010, the first step is to insert a new class diagram file.
    There are many ways to do so, one of which is to click the View Class Diagram button located on
    Solution Explorer's right side (see Figure 2-18; be sure your project - not the solution - is the selected
    item in the window).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_18.png" alt="Figure 2-18" />
    <p><b>Figure 2-18</b> Inserting a class diagram file</p>
    <p>Once you do, you will find class icons that represent the classes in your current project. If you click
    the arrow icon for a given type, you can show or hide the type's members (see Figure 2-19).</p>
    <p><b>Note</b> Using the Class Designer toolbar, you can fine-tune the display options of the designer surface.</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_19.png" alt="Figure 1.1" />
    <p><b>Figure 2-19</b> The Class Diagram viewer</p>
    <p>This utility works in conjunction with two other aspects of Visual Studio 2010: the Class Details
    window (activated using the View ? Other Windows menu) and the Class Designer Toolbox (activated
    using the View ? Toolbox menu item). The Class Details window not only shows you the details of the
    currently selected item in the diagram, but also allows you to modify existing members and insert new
    members on the fly (see Figure 2-20).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_20.png" alt="Figure 2-20" />
    <p><b>Figure 2-20</b> The Class Details window</p>
    <p>The Class Designer Toolbox, which can be activated using the View menu, allows you to insert new
    types into your project (and create relationships between these types) visually (see Figure 2-21). (Be
    aware you must have a class diagram as the active window to view this toolbox.) As you do so, the IDE
    automatically creates new C# type definitions in the background.</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_21.png" alt="Figure 2-21" />
    <p><b>Figure 2-21</b> The Class Designer Toolbox</p>
    <p>By way of example, drag a new Class from the Class Designer Toolbox onto your Class Designer.
    Name this class Car in the resulting dialog box. Now, using the Class Details window, add a public string
    field named petName (see Figure 2-22).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_22.png" alt="Figure 2-22" />
    <p><b>Figure 2-22</b> Adding a field with the Class Details window</p>
    <p>If you now look at the C# definition of the Car class, you will see it has been updated accordingly
    (minus the additional code comments).</p>
    <!-- code formatted by http://manoli.net/csharpformat/ -->
<pre class="csharpcode">
<span class="kwrd">public</span> <span class="kwrd">class</span> Car
{
    <span class="rem">// Public data is typically a bad idea; however,</span>
    <span class="rem">// it keeps this example simple.</span>
    <span class="kwrd">public</span> <span class="kwrd">string</span> petName;
}</pre>
    <p>Now, activate the designer file once again and drag another new Class onto the designer named
    SportsCar. Now, select the Inheritance icon from the Class Designer Toolbox and click the top of the
    SportsCar icon. Next, click the mouse on top of the Car class icon. If you performed these steps correctly,
    you have just derived the SportsCar class from Car (see Figure 2-23).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_23.png" alt="Figure 2-23" />
    <p><b>Figure 2-23</b> Visually deriving from an existing class</p>
    <p>To complete this example, update the generated SportsCar class with a public method named
    GetPetName() authored as follows:</p>
    <!-- code formatted by http://manoli.net/csharpformat/ -->
<pre class="csharpcode">
<span class="kwrd">public</span> <span class="kwrd">class</span> SportsCar : Car
{
    <span class="kwrd">public</span> <span class="kwrd">string</span> GetPetName()
    {
        petName = <span class="str">"Fred"</span>;
        <span class="kwrd">return</span> petName;
    }
}</pre>
    <p>You will make use of these (and other) visual tools of Visual Studio 2010 over the course of this book.
    However, you should now feel a bit more comfortable regarding the basics of the IDE.</p>
    <p><b>Note</b> The concept of inheritance will be fully examined in Chapter 6.</p>
    <h2>The Integrated .NET Framework 4.0 SDK Documentation System</h2>
    <p>The final aspect of Visual Studio 2010 you must be comfortable with from the outset is the fully
    integrated help system. The .NET Framework 4.0 SDK documentation is extremely good, very readable,
    and full of useful information. Given the huge number of predefined .NET types (which number well
    into the thousands), you must be willing to roll up your sleeves and dig into the provided
    documentation. If you resist, you are doomed to a long, frustrating, and painful existence as a .NET
    developer.</p>
    <p>If you have an internet connection, you can view the .NET Framework 4.0 SDK documentation
    online at the following web address:</p>
    <p>http://msdn.microsoft.com/library</p>
    <p>Of course, if you do not have a live internet connection, this is not very useful. Thankfully, you can
    install the same help system locally to your computer. Assuming you have already installed Visual Studio
    2010, navigate to the All Programs | Microsoft Visual Studio 2010 | Visual Studio Tools folder using your
    Windows Start button, and select the Manage Help Settings tool. Once you have done so, you can then
    elect to add the help documentation you are interested in, as seen in Figure 2-24 (if hard drive space
    allows, I'd recommend adding all possible documentation).</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_24.png" alt="Figure 2-24" />
    <p><b>Figure 2-24</b> The Help Library Manager allows you to download a local copy of the .NET Framework 4.0
    SDK Documentation</p>
    <p><b>Note</b> Beginning with .NET 4.0, the help system is viewed via your current web browser, even if you do a local
    installation of the .NET Framework 4.0 SDK documentation.</p>
    <p>Once the local help system is installed, the simplest way to interact with the documentation is to
    select a C# keyword, type name or member name within the Visual Studio 2010 code window, and press
    the F1 key. This will automatically open a documentation window for the selected item. For example, select
    the string keyword within your Car class definition. Once you press F1, you will see the Help page appear.</p>
    <p>Another useful aspect of the documentation is the Search edit box located on the upper left area of
    the display. Here you can enter in the name of any namespace, type, or member and navigate to the
    correct location. If you were to try to search for the System.Reflection namespace, you would be able to
    learn about the details of this namespace, examine the contained types, view code examples, and so
    forth (Figure 2-25)</p>
    <img src="http://www.diggen.co.uk/Images/Figure02_25.png" alt="Figure 2-25" />
    <p><b>Figure 2-25</b> The Search edit box allows you to look up items of interest</p>
    <p>Each node in the tree defines the set of types in a given namespace, the members of a given type,
    and the parameters of a given member. Furthermore, when you view the help page for a given type, you
    will be told the name of the assembly and namespace that contains the type in question (located at the
    top of said page). As you read through the remainder of this book, I assume that you will dive into this
    very, very critical node to read up on additional details of the entity under examination.</p>
    <p><b>Note</b> At the risk of sounding like a broken record, I really can't emphasize enough how important it is that you learn
    to use the .NET Framework 4.0 SDK documentation. No book, no matter how lengthy, can cover every aspect of the
    .NET platform. Make sure you take some time to get comfortable using the help system'you'll thank yourself later.</p>
</body>
</html>
